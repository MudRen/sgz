                       战争攻方
                                 N
                       国家宣战──cannot cmd war
                          │Y
                   进攻城市召开会议
            ┌──────┼──────┐
         安定90       军粮可支持   训练度和士气
            │        现有士兵数   都超过60。
            │        一年以上。        │
            └──────┼──────┘
                         Y│N, cannot cmd war
            ┌──────┼──────┐
        目标城市邻近   单独出兵    目标城市邻近
        有本国城池，      │       有盟国城池，
        共同进攻。        │       邀请共同进攻
            │            │       盟国Y│N非盟国，over
        助攻城市会议      │       助攻城市会议
      ┌──┴──┐      │      ┌──┴──┐
 安定90   训练士气超过60  │   安定90    训练士气超过60
      └──┬──┘      │      └──┬──┘
           Y│N, over     │           Y│N,over
      cmd assistwar    cmd war     cmd assistwar
            ├──────┼──────┤
           分兵     分兵，带粮，金     分兵
      over N│Y          Y│N,all over.Y│N,assist over
            └──────┼──────┘
         进入战场后全部消耗主战部队的粮食，金
                          │
                          战
        ┌────────┴────────┐
      攻方胜                       攻方败或主攻主将撤退
主战部队占领城池，其余         所有未被歼灭之部队撤回原驻地，
助攻部队撤回原驻地，战         主战城市安定下降，助攻城市安定
后被占领区安定为X， 太         亦然，惩罚减半。
守可张贴安民告示以期增
安定。
        └────────┬────────┘
                       war over

注1：宣战，需要由国君决定或国君不在线时举行国家会议，国家会议
     由拥有朝廷官职或州太守的玩家或NPC投票，blah blah
注2：携带军粮，现有战争模式里没有明显时间限制，军粮消耗待决。
     军粮消耗光，士兵逃跑，逃跑比例待决，最好不要下降士气，因
     若在战场士气为 0 则完全无法恢复。
注3：共同进攻，只可要求一个城市共同进攻，决定邀请之后派出官员
     邀请，该官员不得参战，如被邀请城市开会否决，则无共同进攻
     部队。主战部队发出邀请之后可进行分兵，助攻部队将比主战部
     队迟进入战场。如助攻城市安定低于90，则系统显示“本城的民
     心未定，哪能再派兵出征呀。”(or so)
注4：部队训练和士气，如低于60(or so)则系统显示“如此散兵游勇
     如何能打仗，blah blah”。胜方军队训练上升5，士气上升10，
     (or so)，败则反之。
注5：盟国军队助攻要否赠送钱粮待决，因为如果共同进攻的话，主要
     是玩家与玩家之间的沟通，不是光荣三国里的NPC，so...待决。
注6：主战部队携带粮，金上限以不超过所携带部队士兵数200倍较为
     妥当，如无上限，则由富庶城市出兵可横扫全国，因为可以不停
     开仓赈粮，固定上限则限制出兵数目，故有此议。携带金的数目
     可固定，为5000－10000，作用见下。
注7：金的作用，现有的cmd warinfo 能提供敌友军几乎所有状况，包
     括所在区域，士兵数，主将数目等，与真实战争不符。因此，可
     在战争中增加一刺探敌情，原cmd warinfo 只可观看己友军的状
     况，cmd warinfo enemy xxx 可刺探敌军状况，xxx 为投入刺探
     敌情收买当地居民所用，可设上限为500，下限100，成功机率为
     gold/10 + random(30)，* grin。攻防方都要消耗金才能打探敌
     军情报，如金消耗完则无法刺探。其他如 cmd warmap here，只
     能在敌军靠近时才能发现敌踪。这样如果进攻前没有足够的spy
     或战时不够金，只好。。。* smirk。无论主攻助攻部队查看一
     次都消耗主战部队所携带的金，因此鼓励加强沟通。and, cmd
     warinfo enemy xxx will have busy time.
注8：攻方战胜后，当地太守可在10分钟之内张贴安民告示，安定上升
     太守的 魅力值/10 + 2, (or so) 安定的上升由调整税率、探访
     当地居民、开仓赈粮、巡逻抓获小偷，或可加上裁减部分军队令
     士兵屯田增加。下详述：
     税率：限定每次调整幅度不可超过20(or so)，另外可设成税率
     每个月只能调整一次。
     探访：似乎现在visitpeople有bug，if fixed, it's a good way.
     开仓：现在的开仓赈粮is fine.
     巡逻：it's good if many ppl in the attacking troops, and
           they can keep patroling to catch for the safety.
     裁军：裁军令士兵解甲归田，所裁部分纳入当地人口，可增加地
           方安定，it can be if 10% of troops was cut, safety
           add 5, not an appreciated way, but can save in some 
           urgent situation.
     顺带再提一些新的想法：
     丰收：每年的收获季节，会有某些系统随机选择的城市丰收，如
           当地太守为在线玩家，会有居民邀请太守参加丰收庆典，
           如果每个城市都将有新田和农业官blah blah，可以设置
           为ask officer about celebration,(or so)，可根据太守
           的魅力值来确定上升的安定。丰收的城市会增加农业指数，
           如太守参加庆典则还增加安定。
     拜祭天地：每年一月，可由当地在线玩家太守带领属民拜祭，以乞
               风调雨顺，国泰民安，具体计算公式待决，另外可设置
               每个玩家每年只能拜祭一次，避免国君可周游属土，拜
               得头破血流。


                       战争防守

         邻近敌国城市宣战，立即召开紧急防御会议
            ┌──────┼──────┐
        本城市邻近     单独防守    本城市邻近
        有本国城池，      │       有盟国城池，
        共同防守。        │       请求共同防守
            │            │       盟国Y│N非盟国，over
        协防城市会议      │       协防城市会议
      ┌──┴──┐      │      ┌──┴──┐
 安定60   训练士气超过60  │   安定60    训练士气超过60
      └──┬──┘      │      └──┬──┘
           Y│N, over     │           Y│N,over
      cmd assistdefence   │     cmd assistdefence
            ├──────┼──────┤
           分兵          分兵          分兵
      over N│Y           │           Y│N,assist over
            └──────┼──────┘
     进入战场，所有防守部队消耗城市所拥有的钱粮
              ┌─────┴─────┐ 
      主力防守部队在           协防部队出现方式与
      主帅帐或城池内           进攻部队类似，随机
      进入战场。               分布在野外。
              └─────┬─────┘
                          战
              ┌─────┴─────┐ 
     防守成功，安定上升。  防守失败，协防部队撤回原驻地
                           协防城市安定不变。
              └─────┬─────┘
                       war over

注1：协防，需要一名官员请求协防，该官员不得参战，基本同共同
     进攻。问题是如果助攻或协防的城市全部是NPC，如何决定是否
     助攻或协防，以及派出的官员是否由系统随机指定，待决。
注2：协防城市安定及训练士气，如不合要求则系统显示“本城的民
     怨沸腾，自顾还不暇，blah blah”and “如此散兵游勇还能派
     出去协防？省省吧，blah blah”。
注3：协防部队分兵失败，协防失败。
注4：主力防守部队的分兵需要作部分改动：
     1、设定最小带兵量，例如20%(or so) of total amount,防止
        大米们在防守时作弊只带极少量部队防守，因为在防守会议
        上系统自动设定在线的官员统领部队。
     2、不必所有官员全部参战，现在似乎如果是NPC领军的话，所
        在线或NPC官员全部编进军团建制里面，
注5：城池攻防战，将城墙设置为实质阻挡物，有一定的防御度，可
     在平时增加修筑城墙的工作，上限为xxx，待决。现在有两种
     想法，一是将城墙设置成防守方可以任意穿越或停留，攻方则
     必须将城墙的防守度降为 0 才能通过，这样会相应提高防守的
     质量，而防守方在城墙上可以直接攻击攻方，这个想法的优点
     是code起来比较简单，但不会耐玩；二是code比较复杂的，至
     少我以为，一如San3和San4，城墙和城门为高于平地的阻挡物，
     防守方从内侧登上城墙后，将不能直接出城和以直接攻击的方
     式进行攻击，可以用弓箭或落石计，其他需要接敌或需要在同
     一平面上的计谋亦不能使用，而且只能从内侧才能退下城墙，
     防守方通过城墙可以用cmd entercity，或由友军部队从内侧
     cmd opendoor，才能进入；相对而言，攻方部队可以选择将一
     处城门击破，然后从该缺口进入，到达另一城门内侧，也使用
     cmd opendoor来开城放入友军部队，我想这样会增加战争的对
     抗性和协作性，但可能code起来非一般麻烦。* face
注6：关于落石，在San4里，落石的石头是无限的，只要武将有体力
     就可以了，我想我们可以增加采石、伐木的工作来增加城市所
     拥有的滚石檑木，只有充足准备的城市才能增加稳守城池，以
     少胜多的把握。
注7：关于城墙防御度，可以增加工作修筑城墙，max 200(or so)
     或者可以再增加修筑城墙需要石头和木料。
注8：俘虏的问题。现在我们基本上是败了就当贤人，没有俘虏这一
     概念，但因为我们已经有了牢房，这俘虏的问题应该可以实现。
     无论攻防，被击溃的军团首领都有机会成为敌方俘虏，* grin
     random(50)? 然后被俘的将领将在牢房里呆上10－15分钟，待
     决。然后可以分营救俘虏和赎回俘虏，分别为中级工作和外交。
     need discuss.

                     非战争直接相关项

结盟：因为现在的发展趋势已经主要成为玩家国君的国家，所以如果
      以敌对度或友好度来衡量似乎是没有用的，建议先将结盟设置
      成不能朝令夕改的制度，如若结了盟，则不能互相宣战，可以
      作战，当然，因为是玩家国君，可以随时解约，而我想我们并
      不希望盟约成为儿戏，那么就可以设置一些惩罚。
      譬如，结盟上限为 10 年，下限为 1 年，如果有一方在同盟
      期间的一半时间内解约，则全国安定下降 5%，所有将领官员
      忠诚度下降 5%，所有军队士气下降10 blah blah, *grin
      关于敌对度或友好度，可以在进行破坏工作时体现出来，如果
      官员申请有关谣言、策反、破坏、间谍、纵火blah blah 的工
      then 高敌对度的国家会成为优先考虑对象，敌对度和友好度
      判定由该国官员被捕次数或者由该国官员的平均与敌国关系来
      作为标准，need discuss ... :PPP，待决。
      进贡或援助近期内该不设为考虑范围，因为国库功能尚未完善，
      运输亦然，所以难免以期两个友好国家之间互相狂进贡，关系
      奇好，但大家只是把钱粮运来运去，什么损失也没有。

天灾：每个历史时期都有天灾，尤其三国游戏里，几乎没一代没有天
      灾的，所以应该加入天灾以影响城市的指数。
      天灾有洪水、蝗虫、瘟疫、飓风blah blah，各种损失都不同，
      唯一相同的就是一定会影响当地安定，而如果在天灾的情况下
      做某些加强安定的工作，效果可能加倍或减半。* smirk
      待决。
      由此又可以引发出治水的工作，只是一时还没有头绪，又待决。

人祸：我想我们的土匪们太小规模了，缺乏有组织的领导，群龙无首，
      还停留在小打小闹的阶段，需要我们大力发展壮大。
      首先，我们可以分开流匪和悍匪两类，流匪则是我们曾经有的
      土匪和黄巾军，大城无害，小城遭殃；悍匪则是我们应大力引
      的有名有姓的好同志，如张角、程远志，还有孟获同志严格来
      说应该是名好土匪，这一类的悍匪手握重兵，随时可能抢粮草，
      稀里糊涂加入某些战役，将某些久不治理的城市洗劫一空，blah
      blah，总之一句话来说，土匪们将对三国的贡献巨大，后面再
      详述。

人才工作：more npc, more power, what we need now is try to make
          more npc, *hurry yuyin

破坏工作：现在的破坏基本是没有目的，没有效果的，因为根本找不到
          具体的指向，纯粹为个人指标努力，建议作些区域限制，譬
          如，国君可指定向某些州进行破坏，当然，可以在国君专用
          的menu里面悄悄设置，国君总有一点点点特权。以下是一些
          破坏工作：
    谍报：战前必要准备的功课，因为以前的城市不多，所以spy几次
          也就把周围的情况弄得清清楚楚了，将来如果99个城市全部
          完工，没有明确目标的谍报工作将失去其应有的意义，所以
          应该让国君指定某些特定区域来做此工作。引用州的概念是
          出于让其指定的区域不至于太有目的又不至于失去目的:P,
          可以设置成让系统将所有不属于本国的州随机分成三组让国
          挑一组，blah blah, discuss bah.
    煽动：降低敌国敌城的安定，无疑是为进攻或防止敌国进攻而做，
          同样需要目标性。
    策反：NPC is hot enough, 所以不需要定向也够了。不过定了似乎
          也没有什么不好。
    （下面是随手抓到的想法，但愿可以实现）
    谣言：从太守处领命，从而出发到目标城市到处造谣，遇到ppl就
          造谣，遇到officer也造谣，可以设置成如果对ppl造谣成功，
          则当该城官员探访居民时失败的机率增加，对officer造谣成
          功，则会延迟NPC捐钱弥补自己不忠的时间，从而使敌城人才
          流失以致凋零。
    纵火：噢，说过了，纵火降安定、降城市指数、降钱粮物资。
    破坏：破坏是尽量破坏敌国的城防度，以及说不定可以顺手牵羊偷
          滚石檑木回来。
    救俘：初步设想是俘虏关在牢房里，本国官员前来营救，首先要过
          了司隶校尉那一关，如果被抓起来则任务失败，通过了之后
          再在狱卒身上作文章，blah blah, discuss
    赎俘：召开地方会议，派出官员与俘虏所在城太守交涉，blah blah

建设工作：现有的城市建设玩家所能出的力只是不停地增加安定和找NPC，
          对于城市的发展可以说是束手无策。建设工作我们其实有了，
          新田如果完善了的话，可以推广全国一起学习，在每个城市
          都有可以发展地方工业、农业、商业等的私家地方，不用每次
          跑长安去为他人作嫁。
    新田：新田的意念很好，但是以前我曾经做过的经验来看，只有开始
          的时候输入一串指令，之后大概就是发发呆，不过倒是对新手
          的一个机会。如果能再加点什么什么的让主事的官员不要这么
          以及在工作中如果累了可以离开新田睡觉就好了。
    作坊：可以和新田的code类似，但还可以发展成各个城市有特色的地
          工业，如东南的丝绸，西南的蜀锦, blah blah
    商队：现有的商队是随机在某些城市逗留，如果可以以某种代价吸引
          商队来设立市场，譬如本城有某些制品可以卖的，又或者将商
          队设置成双向交流，有买有卖，只是会比较复杂一些，还没有
          具体的概念。
    输送：基本上军队的移动时机还没有成熟，闪击战不是我们所希望看
          到的，但一般输送还是可以做一下，也好让土匪们活动一下，
          问题是，如何让土匪们有机可成，用随机的计算还是设置一些
          随机的warroom，让他们大展拳脚，如果用随机的计算，这个工
          比较没有意义，纯粹是运输没有意思。但如果在途中设置一些
          特殊的warroom，是不是就能解决一下土匪大哥们的温饱哦。
          待决。
    开山：可以在某些城市地图上加些石山，可以以新田的方式雇佣劳工
          做苦力，或者把石山到处摆？如“听说某地发现了一处新石矿，
          blah blah
    伐木：可以和 chuniang 的工作混淆吗？如果可以就简单了。
    筑城：新建城墙或修复城墙，增加本城的防御能力。

                   其他不关战争事的问题

小城：现在小城池小关卡已经不是大城市最好的屏障，而是累赘了，基本
      上也没有什么人到小城市发展，而国君则会选择任其自生自灭，加
      上现在的“国库提金”，如果在一个安定为 0 的城市，国君是可
      把国库的钱全部转移到私人帐户，而并没有损失，安定为 0 之后
      再怎么降也不会低于 0 。如果我们能设置成若该国某一城市久未
      治理，或安定为0，则每个月全国的安定都会下降。如果让那些安
      过低的城市暴动甚至独立的话，国君会再度兴兵攻占，之后还是不
      加以治理。
